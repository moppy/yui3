YUI.add("event-delegate",function(G){var D=G.Array,B=G.Lang,A=B.isString,F=G.Selector.test,C=G.Env.evt.handles;function E(Q,S,J,I){var O=D(arguments,0,true),P=A(J)?J:null,N=Q.split(/\|/),L,H,K,R,M;if(N.length>1){R=N.shift();Q=N.shift();}L=G.Node.DOM_EVENTS[Q];if(B.isObject(L)&&L.delegate){M=L.delegate.apply(L,arguments);}if(!M){if(!Q||!S||!J||!I){return;}H=(P)?G.Selector.query(P,null,true):J;if(!H&&A(J)){M=G.on("available",function(){G.mix(M,G.delegate.apply(G,O),true);},J);}if(!M&&H){O.splice(2,2,H);if(A(I)){I=G.delegate.compileFilter(I);}M=G.on.apply(G,O);M.sub.filter=I;M.sub._notify=E.notifySub;}}if(M&&R){K=C[R]||(C[R]={});K=K[Q]||(K[Q]=[]);K.push(M);}return M;}E.notifySub=function(K,P,I){P=P.slice();if(this.args){P.push.apply(P,this.args);}var N=P[0],J=E._applyFilter(this.filter,P),H=N.currentTarget,L,O,M;if(J){J=D(J);for(L=J.length-1;L>=0;--L){M=J[L];P[0]=new G.DOMEventFacade(N,M,I);P[0].container=H;K=this.context||M;O=this.fn.apply(K,P);if(O===false){break;}}return O;}};E.compileFilter=G.cached(function(H){return function(J,I){return F(J._node,H,I.currentTarget._node);};});E._applyFilter=function(K,J){var M=J[0],H=M.currentTarget,L=M.target,I=[];J.unshift(L);while(L&&L!==H){if(K.apply(L,J)){I.push(L);}J[0]=L=L.get("parentNode");}if(I.length<=1){I=I[0];}J.shift();return I;};G.delegate=G.Event.delegate=E;},"@VERSION@",{requires:["node-base"]});